const {
  GoogleGenerativeAI,
  HarmCategory,
  HarmBlockThreshold,
} = require("@google/generative-ai");

const apiKey = process.env.NEXT_PUBLIC_GEMINI_API_KEY;
const genAI = new GoogleGenerativeAI(apiKey);

const model = genAI.getGenerativeModel({
  model: "gemini-2.0-flash-lite",
});

const generationConfig = {
  temperature: 0.7,
  topP: 0.95,
  topK: 64,
  maxOutputTokens: 8192,
  responseMimeType: "application/json",
};

export const chatSession = model.startChat({
  generationConfig,
  history: [
    {
      role: "user",
      parts: [
        {
          text: 'Kamu adalah ai merekomendasikan mobil toyota berdasarkan prefrensi input pengguna. berikut adalah list data mobil dengan nama adalah sebagai id, pastikan nama sesuai dengan di database. berikut database:Toyota-Dyna. Truk komersial tangguh & efisien untuk bisnis. Ditenagai mesin diesel 4.009 cc dengan turbocharger dan intercooler, Dyna 2025 menghasilkan tenaga hingga 130 ps. Varian: 115ST, 136HT HI-Gear, dan 136HT HI-Gear (PTO). Warna: WHITE, RED. Harga:507.300.000-511.800.000. Gambar: [https://res.cloudinary.com/dlcljeoih/image/upload/v1736913462/mobil_komersil/rsdmv2tbewlfh5bdzzts.png]. Toyota-Hiace. Kendaraan komersial ideal untuk travel & pariwisata. Kapasitas 10-16 penumpang dengan kabin luas. Ditenagai mesin diesel Super GD Engine - VNT Turbo 2.755 cc yang andal dan efisien, menghasilkan tenaga 156.4 ps. Varian: Commuter dan Premio. Warna: WHITE, SILVER METALLIC, BEIGE METALLIC.Harga:670.000.000 - 576.800.000. Gambar: [https://res.cloudinary.com/dlcljeoih/image/upload/v1736913249/mobil_komersil/ikjs9wa3t3wduyhpjper.png]. Toyota-Hilux-4x2. Pickup andal & tangguh untuk bisnis dan komersial dengan daya angkut optimal. Varian single cabin dan double cabin. Pilihan mesin: bensin 1TR-FE 1.998 cc (139 ps) atau diesel 2GD-FTV 2.393 cc (149.6 ps). Warna: SUPER WHITE II, GRAY METALLIC, ATTITUDE BLACK MICA, CRIMSON RED. Harga:295.300.000 - 420.400.000 .Gambar: [https://res.cloudinary.com/dlcljeoih/image/upload/v1736912406/mobil_komersil/k9mmo0vzibmjrlgl5zy1.png]. Toyota-Hilux-4x4. Pickup 4x4 performa off-road tangguh dan handal. Mesin diesel 2.393 cc DOHC VNT Intercooler bertenaga 149.6 ps dengan sistem 4x4 cerdas. Warna: SUPER WHITE II, GRAY METALLIC, SILVER METALIK, ATTITUDE BLACK MICA. Harga:451.300.000 - 535.200.000 Gambar: [https://res.cloudinary.com/dlcljeoih/image/upload/v1736912997/mobil_komersil/vee24pzapi7izeoc9v6j.png]. Toyota-Hilux-Rangga. Kendaraan niaga tangguh & efisien untuk berbagai kebutuhan bisnis. Warna: WHITE. Harga:196.100.000 - 310.300.000. Gambar: [https://res.cloudinary.com/dlcljeoih/image/upload/v1736913586/mobil_komersil/xttj3yiadleee8k47b19.png]. Toyota-Agya. City car efisien & praktis untuk mobilitas perkotaan. Mesin 1.200 cc Dual VVT-i responsif dan irit bahan bakar. Warna: GRAY METALLIC, RED MICA METALLIC, SILVER METALLIC, WHITE, BLACK, YELLOW. Harga : 188.700.000 - 211.900.000. Gambar: [https://res.cloudinary.com/dlcljeoih/image/upload/v1736913773/mobil_hatchback/vdmptcgdzmqxq1jsbq1x.png]. Toyota-Agya-GR-Sport. City car sporty dengan value for money, harga mulai Rp 260 jutaan. Mesin WA-VE 1.200 cc (88 ps) dengan transmisi manual/CVT sporty. Warna: RED MICA METALLIC, BLACK, YELLOW, BLACK-WHITE, BLACK - RED MICA METALLIC. Harga: 260.200.000 - 278.700.000 .Gambar: [https://res.cloudinary.com/dlcljeoih/image/upload/v1736909954/mobil_hatchback/idu4jgkcukhe3otvdsmz.png]. Toyota-Yaris. Hatchback modern, gaya & efisien untuk keluarga muda. Mesin bensin 1.496 cc responsif. Varian GR Sport sporty dengan transmisi CVT paddle shift. Warna: SUPER WHITE II, GRAY METALLIC, ATTITUDE BLACK MICA, CRIMSON RED. Harga: 333.100.000 - 349.300.000 .Gambar: [https://res.cloudinary.com/dlcljeoih/image/upload/v1736909954/mobil_hatchback/ln4sbbmhm54myji1eycc.png]. Toyota-Avanza. MPV populer 7 penumpang dengan kenyamanan & fitur modern. Mesin 1.329 cc / 1.496 cc dengan transmisi otomatis efisien. Warna: GRAY METALLIC, PURPLISH SILVER M. M, SILVER METALLIC, WHITE, BLACK MICA. Harga: 261.900.000 - 324.700.000 .Gambar: [https://res.cloudinary.com/dlcljeoih/image/upload/v1736911578/mpv_car/o1jjlxxbu3cuvus6hclt.png]. Toyota-Calya. MPV kompak efisien & fungsional. Mesin 1.197 cc Dual VVT-i (88 ps) irit BBM. Warna: GRAY METALLIC, DEEP MAROON MICA, BRONZE M.M, ORANGE METALLIC, SILVER METALLIC, WHITE, BLACK. Harga : 191.400.000 - 214.000.000 .Gambar: [https://res.cloudinary.com/dlcljeoih/image/upload/v1736911752/mpv_car/unfzojrzfbghxdnujnnb.png]. Toyota-Veloz. MPV premium modern & sporty. Interior luas, fitur canggih. Mesin 1.500 cc Dual VVT-i dengan transmisi manual/CVT. Warna: SILVER METALLIC, BLACK MICA, PLATINUM WHITE PEARL MICA. Harga : 314.600.000 - 362.600.000 .Gambar: [https://res.cloudinary.com/dlcljeoih/image/upload/v1736911578/mpv_car/t2ecwfwmp98405zdadlv.png]. Toyota-Innova-Zenix. MPV modern elegan performa andal. Interior mewah, kabin lega. Mesin 1.987 cc CVT. Warna: SILVER METALLIC, ATTITUDE BLACK MICA, PLATINUM WHITE PEARL MICA. Harga: 438.900.000 - 486.000.000 .Gambar: [https://res.cloudinary.com/dlcljeoih/image/upload/v1736911577/mpv_car/c8oslgdokoq7bwakylss.png]. Toyota-Alphard. MPV premium mewah & nyaman. Generasi terbaru inovatif. Warna: BLACK, PLATINUM WHITE PEARL MICA. Harga: 1.399.700.000 - 1.700.900.000 .Gambar: [https://res.cloudinary.com/dlcljeoih/image/upload/v1736911577/mpv_car/tfg9gojhrnnkzo4lbnpn.png]. Toyota-Voxy. MPV kelas menengah atas elegan & futuristik. Mesin 1.986 cc performa & efisien. Warna: WHITE PEARL C.S, BLACK. Harga: 626.200.000 - 623.100.000 .Gambar: [https://res.cloudinary.com/dlcljeoih/image/upload/v1736912093/mpv_car/fvc3xgamhvrpawo3tbbf.png]. Toyota-Vellfire-Hybrid. MPV Luxury mewah & sporty. Mesin 2.494 cc (180 ps). Kabin lega, cruise control. Warna: BLACK, PLATINUM WHITE PEARL MICA. Harga: 1.828.200.000 - 1.831.800.000 .Gambar: [https://res.cloudinary.com/dlcljeoih/image/upload/v1736911577/mpv_car/vgbedpisubgwffrdvuxb.png]. Toyota-bZ4X. SUV listrik Toyota futuristik & canggih. Motor listrik 150 kW, baterai 71,4 kWh. Warna: BLACK, HITAM-SILVER, WHITE METALLIC, HITAM-ABU ABU. Harga: 1.203.150.000 - 1.211.150.000 .Gambar: [https://res.cloudinary.com/dlcljeoih/image/upload/v1737535266/bz4x_z7uyd4.png]. Toyota-Corolla-Cross-Hybrid. SUV modern gaya & teknologi. Varian bensin & hybrid 1.798 cc. Warna: ATTITUDE BLACK MICA, BLACK-RED M. M, BLACK - PLATINUM WHITE PEARL. Harga: 613.700.000 - 618.700.000 .Gambar: [https://res.cloudinary.com/dlcljeoih/image/upload/v1737535352/Corolla_Cross_GR_White_23_oydgxy.png]. Toyota-Fortuner-4x2. SUV tangguh performa tinggi. Mesin diesel 2.755 cc (203,9 ps) / 2.393 cc (149.6 ps). Warna: SUPER WHITE II, ATTITUDE BLACK MICA, PLATINUM WHITE PEARL MICA. Harga: 574.800.000 - 667.100.000 .Gambar: [https://res.cloudinary.com/dlcljeoih/image/upload/v1737535757/7664543e-b5da-40e5-8382-9162ce744589_mt4m7n.png]. Toyota-Fortuner-4x4. SUV 4x4 tangguh off-road & nyaman. Mesin diesel, 4x4 canggih. Warna: SUPER WHITE II, ATTITUDE BLACK MICA. Harga: 734.600.000 - 759.500.000 .Gambar: [https://res.cloudinary.com/dlcljeoih/image/upload/v1737535487/fortuner4x4_pigdff.png]. Toyota-Land-Cruiser. SUV premium teknologi & off-road unggul. Varian GR-S (sporty) & VX-R (mewah). Mesin diesel 3.346 cc V6. Warna: GRAY METALLIC, ATTITUDE BLACK MICA, PRECIOUS WHITE. Harga: 2.582.400.000 - 2.644.600.000 .Gambar: [https://res.cloudinary.com/dlcljeoih/image/upload/v1737536279/land-cruiser-black-NON-GR_edfb1b.png]. Toyota-Raize. SUV kompak modern & efisien. Mesin 1.0L turbo (98 ps) / 1.2L (88 ps). Warna: GRAY METALLIC, TURQUOISE MM, RED, SILVER METALLIC, WHITE, BLACK, YELLOW, BLACK-WHITE, BLACK-TURQUOISE MICA METALIK, BLACK-RED, BLACK-YELLOW,BLACK-SILVER METALLIC. Harga: 253.700.000 - 290.300.000 .Gambar: [https://res.cloudinary.com/dlcljeoih/image/upload/v1737536345/raize_white-17optimized_gin7wf.png]. Toyota-Raize-GR-Sport. Compact SUV sporty & bertenaga. Mesin 1.0L turbo (98 ps) / 1.2L (88 ps). Warna: TURQUOISE MM, RED, SILVER METALLIC, WHITE, BLACK, BLACK-WHITE, BLACK-TURQUOISE MICA METALIK, BLACK-RED, BLACK-SILVER METALLIC. Harga: 301.400.000 - 304.100.000 .Gambar: [https://res.cloudinary.com/dlcljeoih/image/upload/v1737536353/raize_gray_metallic-_17optimized_h04wog.png]. Toyota Rush. SUV kompak 7-seater sporty & nyaman. Mesin 1.496 cc (104 ps). Warna: SILVER METALLIC, DEEP MAROON MICA, BRONZE M.M, WHITE, BLACK MICA. Harga: 306.400.000 - 331.700.000 .Gambar: [https://res.cloudinary.com/dlcljeoih/image/upload/v1737536895/Rush_z5roeq.png]. Toyota-Yaris-Cross. SUV kompak desain \\\'Solid & Dynamic\\\'. Mesin 1.500 cc (78 kW). Warna: SUPER WHITE II, ATTITUDE BLACK MICA, DEEP MAROON MICA, HIJAU TUA METALIK, SILVER METALLIC. Harga: 363.600.000 - 419.400.000  .Gambar: [https://res.cloudinary.com/dlcljeoih/image/upload/v1737536914/all-new-yaris-cross-SUV_twjl3o.png]. Toyota-Camry. Sedan mewah elegan & bertenaga. Mesin 2.494 cc, akselerasi mulus. Warna: SILVER METALLIC, METAL STREAM ME, ATTITUDE BLACK MICA. Harga: 803.500.000 - 806.600.000 .Gambar: [https://res.cloudinary.com/dlcljeoih/image/upload/v1737602113/all-new-camry-18_zv5fq0.png]. Toyota-Corolla-Altis. Sedan elegan modern performa mesin bertenaga. Mesin 1.798 cc (140 ps). Warna: CELESTITE GRAY M. E, ATTITUDE BLACK MICA, PLATINUM WHITE PEARL MICA. Harga: 577.100.000 - 580.100.000 .Gambar: [https://res.cloudinary.com/dlcljeoih/image/upload/v1737602112/all-new-corolla-altis-18_zjrii1.png]. Toyota-Vios. Sedan andal teknologi & keselamatan modern. Mesin 1.496 cc (106 PS), desain aerodinamis. Warna: METAL STREAM ME, ATTITUDE BLACK MICA, RED MICA METALLIC, ABU-ABU. Harga: 378.100.000 - 392.500.000 .Gambar: [https://res.cloudinary.com/dlcljeoih/image/upload/v1737602112/metal_optimized_2_ckldaa.png]. Toyota-Camry-Hybrid. Sedan premium hybrid mewah & efisien. Mesin hybrid 2.5 HV (178 ps + 20.6 ps). Warna: SILVER METALLIC, ATTITUDE BLACK MICA. Harga: 942.100.000 - 945.100.000 Gambar: [https://res.cloudinary.com/dlcljeoih/image/upload/v1737607388/all-new-camry-03_yi2b5u.png] Toyota-Corolla-Altis-Hybrid. Sedan hybrid elegan & efisien. Mesin 1.798 cc + motor listrik (95 ps). Warna: CELESTITE GRAY M. E, ATTITUDE BLACK MICA, PLATINUM WHITE PEARL MICA. Harga: 628.500.000 - 631.500.000 .Gambar: [https://res.cloudinary.com/dlcljeoih/image/upload/v1737607388/all-new-corolla-altis-03_g8ch7x.png]. Toyota-Innova-Zenix-Hybrid. MPV hybrid performa & efisien. Mesin 1.987 cc (174 ps) + motor listrik, CVT. Warna: SILVER METALLIC, GRAY METALLIC, ATTITUDE BLACK MICA, PLATINUM WHITE PEARL MICA. Harga: 485.900.000 - 638.500.000 .Gambar: [https://res.cloudinary.com/dlcljeoih/image/upload/v1737607388/Black_Q360-Exterior_23_tae5gq.png]. Toyota-Yaris-Cross-Hybrid. SUV kompak hybrid performa & gaya modern. Mesin 1.500 cc (91 PS + 80 Nm). Warna: SUPER WHITE II, ATTITUDE BLACK MICA, DEEP MAROON MICA, HIJAU TUA METALIK. Harga: 450.300.000 - 464.900.000 .Gambar: [https://res.cloudinary.com/dlcljeoih/image/upload/v1737607387/all-new-yaris-cross-hev-_24_optimized_s7zwes.png]. Toyota-GR-86. Mobil sport bertenaga & stylish. Mesin 2.387 cc (235 PS), lincah. Warna: CRYSTAL BLACK SILICA, IGNITION RED, ICE SILVER METALLIC, CRYSTAL WHITE PEARL, MAGNETITE GRAY METALLIC, SAPPHIRE BLUE PEARL. Gambar: [https://res.cloudinary.com/dlcljeoih/image/upload/v1737609513/gr86_b2s5cs.png]. Toyota-Supra. Mobil sport futuristik & performa tinggi. Mesin 2.998 cc (387 ps) turbo, transmisi 8-speed. Warna: WHITE METALLIC, ICE GRAY METALLIC, BLACK METALLIC, PROMINENCE RED. Gambar: [https://res.cloudinary.com/dlcljeoih/image/upload/v1737609512/supra_rkmu7u.png].Toyota-Innova-Reborn. Toyota Innova Reborn Tipe G merupakan MPV keluarga yang nyaman, lega, dan handal, menawarkan keseimbangan antara fitur, performa, dan harga. Tersedia dalam tiga pilihan: REBORN G 2.0 M/T Bensin dengan mesin 1.998 cc 1TR-FE (139 PS) dan transmisi manual; REBORN G 2.4 M/T Diesel dengan mesin 2.393 cc 2GD-FTV (149 PS, torsi 343 Nm) dan transmisi manual; serta REBORN G 2.4 A/T Diesel dengan mesin 2.393 cc 2GD-FTV (149 PS, torsi 360 Nm) dan transmisi otomatis 6-percepatan. Gambar: [https://res.cloudinary.com/dlcljeoih/image/upload/v1740388845/Kijang_innova_1_ilv3uq.png].\nTugasmu sekarang adalah merekomendasikan 2 mobil Toyota yang paling sesuai dengan preferensi pengguna berdasarkan input berikut: Budget antara :100.000.000 - 500.000.000 juta, kategori mobil :Komersil, kebutuhan utama :Bisnis, penggunaan untuk :Harian, lokasi domisili :rantauprapat. berikan output hanya json berisi data seperti mobil yang direkomendasikan,categori, type mobil,transmisi,bahan bakar,alasan,beserta imageurl nya dan buat alasan agar customer tertarik dan berpikir relate. Jika tidak ada mobil yang sesuai, berikan jawaban rekomendasi yang paling cocok atau mendekati data berdasarkan input pengguna. output json format:{\\n  "rekomendasi": [\\n    {\\n      "nama_mobil": "",\\n      "kategori": "",\\n      "tipe": "",\\n      "transmisi": "",\\n      "bahan_bakar": "",\\n      "alasan": "",\\n      "image_url": ""\\n    }\\n  ]\\n}.\\n\'',
        },
      ],
    },
    {
      role: "model",
      parts: [
        {
          text: '```json\n\n{\n  "rekomendasi": [\n    {\n      "nama_mobil": "Toyota-Hilux-4x2",\n      "kategori": "Komersial",\n      "tipe": "Pickup",\n      "transmisi": "Manual",\n      "bahan_bakar": "Bensin atau Diesel",\n      "alasan": "Sebagai seorang pebisnis di Rantauprapat, Anda membutuhkan kendaraan yang tangguh, andal, dan memiliki daya angkut optimal untuk mendukung operasional bisnis harian Anda. Toyota Hilux 4x2 menawarkan dua pilihan mesin, yaitu bensin dan diesel, yang dapat disesuaikan dengan kebutuhan dan preferensi Anda. Varian single cabin sangat cocok untuk memaksimalkan daya angkut barang, sementara double cabin dapat menjadi pilihan jika Anda juga membutuhkan kendaraan untuk mengangkut pekerja atau keluarga. Dengan rentang harga Rp295.300.000 - Rp420.400.000, Hilux 4x2 menawarkan nilai terbaik untuk investasi bisnis Anda.",\n      "image_url": "https://res.cloudinary.com/dlcljeoih/image/upload/v1736912406/mobil_komersil/k9mmo0vzibmjrlgl5zy1.png"\n    },\n    {\n      "nama_mobil": "Toyota-Dyna",\n      "kategori": "Komersial",\n      "tipe": "Truk",\n      "transmisi": "Manual",\n      "bahan_bakar": "Diesel",\n      "alasan": "Jika bisnis Anda di Rantauprapat membutuhkan kendaraan komersial dengan kapasitas angkut yang lebih besar dan performa tangguh, Toyota Dyna adalah pilihan yang tepat. Ditenagai mesin diesel 4.009 cc dengan turbocharger dan intercooler, Dyna siap menghadapi berbagai medan dan tantangan di Rantauprapat. Dengan harga yang berkisar antara Rp507.300.000 hingga Rp511.800.000, Dyna mungkin sedikit di atas budget Anda, namun truk ini menawarkan daya tahan dan efisiensi bahan bakar yang lebih baik, sehingga dapat menjadi investasi jangka panjang yang menguntungkan bagi bisnis Anda. ",\n      "image_url": "https://res.cloudinary.com/dlcljeoih/image/upload/v1736913462/mobil_komersil/rsdmv2tbewlfh5bdzzts.png"\n    }\n  ]\n}\n```',
        },
      ],
    },
  ],
});

// const result = await chatSession.sendMessage("INSERT_INPUT_HERE");
// console.log(result.response.text());
